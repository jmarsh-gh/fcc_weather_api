<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Weather</title>
</head>
<body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script> 
<script language="Javascript" type="text/javascript">


function main(){

	//Get city from IP - NOTE adblock blocks this from working - find alt
	$.getJSON("http://ip-api.com/json", function(json) {
	console.log(json);
	var userCity = json.city;
	$(".location").text("Local Weather for" + " " + userCity + ", " + json.countryCode);

	//split url and concatenate above json.city
	var url = "http://api.openweathermap.org/data/2.5/weather?";
	var city = "q=" + userCity;
	var queryStrings = "&units=metric&appid=b247d4b43cbaa161d2cb8e5047cf3a15"
		$.getJSON(url+city+queryStrings, function(json) {
  			$(".message").html(Math.round(json.main.temp) + " degrees Centigrade" + "</br>" + json.weather[0].description);
  			console.log(json.weather[0]);
		},'jsonp');

	}, 'jsonp');
	
	
	

};


$(document).ready(main);

		// "http://api.openweathermap.org/data/2.5/weather?q=Hove&units=metric&appid=b247d4b43cbaa161d2cb8e5047cf3a15"
		// var test = '';
  		// test = JSON.stringify(json.main.temp);
  		// $(".message").html(test);
  		// alert(typeof test);
		// $('<li>').text(JSON.stringify(json.main)).appendTo('.posts');		
		// var mainObj = json.main;
		// $('<li>').text(mainObj.temp).appendTo('.posts');
		// $('<li>').text('').appendTo('.posts');
		// for(var x in mainObj){
			// $('<li>').text([x] + ": " + mainObj[x]).appendTo('.posts');
		// };

</script>

<div>
	<p class="location"></p>
	<button id="cent">C</button>
	<button id="fahren">F</button>
	<p class="message"></p>
	<ul class="posts"></ul>
</div>

</body>
</html>